<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/mvp.css@1.12/mvp.css"> 
    <title>Firebase JS</title>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="stylesheet" href="index.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
</head>

<body>
    <main>
        <header>
            <nav>
                <h1>Firebase Workshop</h1>
                <button style="display: none;" id="logout-btn">Logout</button>
            </nav>
        </header>

        <!-- Unauthenticated section starts -->
        <section id="unauthenticated-section" style="display: flex; flex-direction: column;">
            <form>
                <h1>Create Account</h1>
                <div>
                    <label>Email</label>
                    <input name="email" placeholder="Email" id="email" type="email" />
                </div>
                <div>
                    <label>Password</label>
                    <input name="password" placeholder="Password" id="password" type="password" />
                </div>
                <div>
                    <button 
                        type="text"
                        id="signup-btn"
                        >Sign Up</button>
                </div>
            </form>
            <form>
                <h1>Login</h1>
                <div>
                    <label>Email</label>
                    <input name="email" placeholder="Email" id="email" type="email" />
                </div>
                <div>
                    <label>Password</label>
                    <input name="password" placeholder="Password" id="password" type="password" />
                </div>
                <div>
                    <button 
                        type="text"
                        id="login-btn"
                        >Log In
                    </button>
                </div>
            </form>
        </section>
        <!-- Unauthenticated section starts -->

        <!-- Authenticated section starts -->
        <section id="authenticated-section" style="display: none; flex-direction: column;">
            <h1>âœ… You are Logged In</h1>
        </section>
        <!-- Authenticated section starts -->

    </main>
</body>
<script type="module" src="./firebase.js"></script>
<script type="module" src="./frontend.js"></script>
<script type="module">
    import { app, auth, handleLogin, handleRegister, handleSignOut } from './firebase.js';
    import { renderLoggedInPage, renderLoggedOutPage } from './frontend.js';
    
    // EventListeners
    Array.from(document.getElementsByTagName("form")).forEach(el => {
        el.addEventListener("submit", (e) => {
            e.preventDefault();
        });
    })
    document.getElementById("logout-btn").addEventListener("click", (e) => {
        handleSignOut();
    });
    document.getElementById("signup-btn").addEventListener("click", (e) => {
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        handleRegister(email, password);
    });
    document.getElementById("login-btn").addEventListener("click", (e) => {
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        handleLogin(email, password);
    });

    // Check auth states
    auth.onAuthStateChanged(function(user) {
        if (user) {
            // User is signed in.
            renderLoggedInPage();
        } else {
            renderLoggedOutPage();
        }
    });
</script>

</html>